test_that("test ask_2014_nga vs NGA-West2 spreadsheet", {
  expect_equal(ask_2014_nga(M = 5, T = 1000, Rrup = 90, Rjb = 85, Rx = 85, Ry0 = 80, dip = 80,
                            lambda = 75, after_shock = 0, HW = 1, W = 10, region = 1, Vs30 = 350, Vs30_code = 0)$med[-20],
               c(0.00612835, 0.006227701, 0.006500822, 0.007473693, 0.009175767, 0.010967945, 0.01362716, 0.014435169,
                 0.013769665, 0.012214644, 0.01021941, 0.008390737, 0.004322058, 0.002674514, 0.001497038, 0.000892005,
                 0.000361221, 0.000187775, 0.000110473, 4.86123E-05, 2.47401E-05, 0.00612835, 0.278355692))

  expect_equal(round(ask_2014_nga(M = 5, T = 1000, Rrup = 90, Rjb = 85, Rx = 85, Ry0 = 80, dip = 80,
                            lambda = 75, after_shock = 0, HW = 1, W = 10, region = 1, Vs30 = 350, Vs30_code = 0)$sigma[-20],
                     digits = 4),
               c(0.7769, 0.7791, 0.7872, 0.8020, 0.8049, 0.8053, 0.7942, 0.7856, 0.7769, 0.7659, 0.7495,
                 0.7419, 0.7288, 0.7257, 0.7166, 0.7110, 0.7039, 0.6906, 0.6837, 0.6693, 0.6661, 0.7769,
                 0.6976))
})
