test_that("test ask_2014_nga vs NGA-West2 spreadsheet", {
  expect_equal(round(nga_cena_gmm(M = 6, T = 1000, Rrup = 30, Vs30 = 350)$med,
                     digits = 4),
               round(c(7.087899787941416, 0.14023909543747506, 0.16841746729716178, 0.225250248552878, 0.26904298726114134,
                       0.295450770419361, 0.3213546110994565, 0.33155765750104765, 0.33321474797255424, 0.34121241746938347,
                       0.3372951192428817, 0.33663129434083666, 0.3357198617154597, 0.3343753235662479, 0.33289071116001123,
                       0.3294758347982246, 0.32728156867405234, 0.3236491586547047, 0.32098537503370617, 0.31351843623468795,
                       0.2668579770943835, 0.22915939788477194, 0.2029027922851046, 0.16638899914964186, 0.14017102458168976,
                       0.09342098048546989, 0.08656462515091984, 0.06514863064517755, 0.03458789643151004, 0.02096741228611714,
                       0.00932024170917744, 0.005265583433663364, 0.003298016148435338, 0.0014541813334356033, 0.0007753696834025229),
                     digits = 4))

  expect_equal(round(nga_cena_gmm(M = 6, T = 1000, Rrup = 80, Vs30 = 555)$med,
                     digits = 4),
               round(c(2.1600863835687827, 0.04262750512003175, 0.04893571438605087, 0.06656178151239717, 0.08390825458592052,
                       0.09763340441997001, 0.10807032790032996, 0.11771852863875328, 0.1199746435129434, 0.13089409364314003,
                       0.13242538977094248, 0.1328246964303444, 0.133228066396105, 0.13280101290671623, 0.1315649451695208,
                       0.12767449436963457, 0.12548115512625246, 0.12049220801981038, 0.11849944296772968, 0.11071248728614554,
                       0.08557799180405673, 0.06965459284642551, 0.05988046466200949, 0.046262130044438965, 0.037667315290157224,
                       0.02388562390346082, 0.021936011618798927, 0.016231774042608033, 0.00872866300967311, 0.005477524870739712,
                       0.0024626926873396464, 0.0014462814909759981, 0.000915912974120052, 0.00040112408555023003, 0.0002199703038050446),
                     digits = 4))

  expect_equal(round(nga_cena_gmm(M = 7.1, T = 1000, Rrup = 33, Vs30 = 341)$med,
                     digits = 3),
               round(c(27.794431473991203, 0.28748764043762165, 0.3525259451362257, 0.4825288911081445, 0.5602706610917128,
                       0.6037194596911034, 0.6444000640017704, 0.6597726771999405, 0.6658206514216458, 0.6912609907595247,
                       0.6882398034641378, 0.6885382846160483, 0.6886104278017536, 0.6879208794341707, 0.6868282754521999,
                       0.6844063273749681, 0.6829500872389853, 0.6787170282861725, 0.6756937945810942, 0.6639214286614468,
                       0.5855967352074795, 0.5308030497546636, 0.47997164787636737, 0.42670074860165624, 0.3775122575561915,
                       0.2986899095853884, 0.2845253484988196, 0.23586240596704222, 0.15738209999297412, 0.11198670775399384,
                       0.06214676913601389, 0.03862220404000518, 0.02704945121674057, 0.015125435227499871, 0.009003673700106662),
                     digits = 3))

  expect_equal(round(nga_cena_gmm(M = 5.74, T = 1000, Rrup = 52.5, Vs30 = 297)$med,
                     digits = 4),
               round(c(2.3550868127364684, 0.05322415960138687, 0.06321773739533873, 0.08346365468050548, 0.10108780705863847,
                       0.11420246151750826, 0.1260647031236249, 0.1294134979063292, 0.13070910898673768, 0.13530441190830328,
                       0.1339822303397402, 0.13373558571232033, 0.1334004040529834, 0.13289190178508442, 0.13232813069398353,
                       0.13104226828527776, 0.13023775586303568, 0.12888983970009396, 0.1280174939824507, 0.12545781156884356,
                       0.10723332057880955, 0.09029375048470692, 0.07945931865491627, 0.062492533824107986, 0.05162260966277675,
                       0.032192936928612234, 0.02966887820192154, 0.02179305973529601, 0.010859915747442297, 0.006419437497622071,
                       0.0026534112338272233, 0.0014795768628775758, 0.0009026601710477179, 0.00037769887022344613, 0.00019850217944144497),
                     digits = 4))

})
